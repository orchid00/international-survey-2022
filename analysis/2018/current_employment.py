#!/usr/bin/env python
# coding: utf-8

# <h1>Table of Contents<span class="tocSkip"></span></h1>
# <div class="toc"><ul class="toc-item"><li><span><a href="#Introduction" data-toc-modified-id="Introduction-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Introduction</a></span><ul class="toc-item"><li><span><a href="#Questions-in-this-sections" data-toc-modified-id="Questions-in-this-sections-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Questions in this sections</a></span></li><li><span><a href="#Setting-up" data-toc-modified-id="Setting-up-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Setting up</a></span></li></ul></li><li><span><a href="#Type-of-contract-and-type-of-organisation" data-toc-modified-id="Type-of-contract-and-type-of-organisation-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Type of contract and type of organisation</a></span><ul class="toc-item"><li><span><a href="#Australia" data-toc-modified-id="Australia-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Australia</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.1.1"><span class="toc-item-num">2.1.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.1.2"><span class="toc-item-num">2.1.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.1.3"><span class="toc-item-num">2.1.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.1.4"><span class="toc-item-num">2.1.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.1.5"><span class="toc-item-num">2.1.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.1.6"><span class="toc-item-num">2.1.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.1.7"><span class="toc-item-num">2.1.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.1.8"><span class="toc-item-num">2.1.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.1.9"><span class="toc-item-num">2.1.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#Germany" data-toc-modified-id="Germany-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Germany</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.2.1"><span class="toc-item-num">2.2.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.2.2"><span class="toc-item-num">2.2.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.2.3"><span class="toc-item-num">2.2.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Which-organisation" data-toc-modified-id="Which-organisation-2.2.4"><span class="toc-item-num">2.2.4&nbsp;&nbsp;</span>Which organisation</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.2.5"><span class="toc-item-num">2.2.5&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.2.6"><span class="toc-item-num">2.2.6&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.2.7"><span class="toc-item-num">2.2.7&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.2.8"><span class="toc-item-num">2.2.8&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.2.9"><span class="toc-item-num">2.2.9&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.2.10"><span class="toc-item-num">2.2.10&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#Netherlands" data-toc-modified-id="Netherlands-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Netherlands</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.3.1"><span class="toc-item-num">2.3.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.3.2"><span class="toc-item-num">2.3.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.3.3"><span class="toc-item-num">2.3.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.3.4"><span class="toc-item-num">2.3.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.3.5"><span class="toc-item-num">2.3.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.3.6"><span class="toc-item-num">2.3.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.3.7"><span class="toc-item-num">2.3.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.3.8"><span class="toc-item-num">2.3.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.3.9"><span class="toc-item-num">2.3.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#New-Zealand" data-toc-modified-id="New-Zealand-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>New Zealand</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.4.1"><span class="toc-item-num">2.4.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.4.2"><span class="toc-item-num">2.4.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.4.3"><span class="toc-item-num">2.4.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.4.4"><span class="toc-item-num">2.4.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.4.5"><span class="toc-item-num">2.4.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.4.6"><span class="toc-item-num">2.4.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.4.7"><span class="toc-item-num">2.4.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.4.8"><span class="toc-item-num">2.4.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.4.9"><span class="toc-item-num">2.4.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#South-Africa" data-toc-modified-id="South-Africa-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>South Africa</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.5.1"><span class="toc-item-num">2.5.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.5.2"><span class="toc-item-num">2.5.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.5.3"><span class="toc-item-num">2.5.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.5.4"><span class="toc-item-num">2.5.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.5.5"><span class="toc-item-num">2.5.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.5.6"><span class="toc-item-num">2.5.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.5.7"><span class="toc-item-num">2.5.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.5.8"><span class="toc-item-num">2.5.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.5.9"><span class="toc-item-num">2.5.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#United-Kingdom" data-toc-modified-id="United-Kingdom-2.6"><span class="toc-item-num">2.6&nbsp;&nbsp;</span>United Kingdom</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.6.1"><span class="toc-item-num">2.6.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.6.2"><span class="toc-item-num">2.6.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.6.3"><span class="toc-item-num">2.6.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.6.4"><span class="toc-item-num">2.6.4&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.6.5"><span class="toc-item-num">2.6.5&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.6.6"><span class="toc-item-num">2.6.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.6.7"><span class="toc-item-num">2.6.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.6.8"><span class="toc-item-num">2.6.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.6.9"><span class="toc-item-num">2.6.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#United-States" data-toc-modified-id="United-States-2.7"><span class="toc-item-num">2.7&nbsp;&nbsp;</span>United States</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.7.1"><span class="toc-item-num">2.7.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.7.2"><span class="toc-item-num">2.7.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.7.3"><span class="toc-item-num">2.7.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.7.4"><span class="toc-item-num">2.7.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.7.5"><span class="toc-item-num">2.7.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.7.6"><span class="toc-item-num">2.7.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Salary" data-toc-modified-id="Salary-2.7.7"><span class="toc-item-num">2.7.7&nbsp;&nbsp;</span>Salary</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-2.7.8"><span class="toc-item-num">2.7.8&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.7.9"><span class="toc-item-num">2.7.9&nbsp;&nbsp;</span>Job title</a></span></li></ul></li><li><span><a href="#Rest-of-the-World" data-toc-modified-id="Rest-of-the-World-2.8"><span class="toc-item-num">2.8&nbsp;&nbsp;</span>Rest of the World</a></span><ul class="toc-item"><li><span><a href="#Type-of-organisation" data-toc-modified-id="Type-of-organisation-2.8.1"><span class="toc-item-num">2.8.1&nbsp;&nbsp;</span>Type of organisation</a></span></li><li><span><a href="#In-which-field-are-you-working" data-toc-modified-id="In-which-field-are-you-working-2.8.2"><span class="toc-item-num">2.8.2&nbsp;&nbsp;</span>In which field are you working</a></span></li><li><span><a href="#Which-University" data-toc-modified-id="Which-University-2.8.3"><span class="toc-item-num">2.8.3&nbsp;&nbsp;</span>Which University</a></span></li><li><span><a href="#Type-of-contract" data-toc-modified-id="Type-of-contract-2.8.4"><span class="toc-item-num">2.8.4&nbsp;&nbsp;</span>Type of contract</a></span></li><li><span><a href="#Full-time-or-part-time" data-toc-modified-id="Full-time-or-part-time-2.8.5"><span class="toc-item-num">2.8.5&nbsp;&nbsp;</span>Full time or part-time</a></span></li><li><span><a href="#Length-of-the-current-position" data-toc-modified-id="Length-of-the-current-position-2.8.6"><span class="toc-item-num">2.8.6&nbsp;&nbsp;</span>Length of the current position</a></span></li><li><span><a href="#Job-title" data-toc-modified-id="Job-title-2.8.7"><span class="toc-item-num">2.8.7&nbsp;&nbsp;</span>Job title</a></span></li></ul></li></ul></li></ul></div>

# # Introduction

# ## Questions in this sections
# 
# * `Please select your organization type`: one choice
# * `Which university do you work for?`: one choice
# * `What is your official job title?`: free text
# * `Are you known in your group by a different job title? If so, please enter the job title you use`: free text
# * `Do you work full time or part time`: free text
# * `What is the nature of your current employment?`: one choice
# * `When did you start your current position?`: numeric
# * `What is the expected duration (in years) of your current position (in total)?`: numeric
# * `Please select the range of your salary`: one choice
# * `Which of the following sources are used to pay for your effort as an RSE?`: one choice

# ## Setting up

# In[1]:


get_ipython().run_cell_magic('capture', ' ', '# Import notebook containing the imports the functions and the dataset\n%run "./0. Imports and functions.ipynb"\n\n# Import notebook containing sampled dataset\n%run "./1. Overview and sampling.ipynb"')


# In[2]:


plt.rcParams['figure.figsize'] = [20.0, 10.0]


# # Type of contract and type of organisation

# In[3]:


current_emp = ['currentEmp1. Please select your organization type']

which_uni = ['currentEmp2. Which university do you work for?']

current_field = [x for x in df.columns if x[:len('currentEmp13')] == 'currentEmp13']

title_job = ['currentEmp5. What is your official job title?']
diff_title = ['currentEmp6. Are you known in your group by a different job title? If so, please enter the job title you use']

contract_time = ['currentEmp12. Do you work full time or part time']

nature_contract = ['currentEmp10. What is the nature of your current employment?']

start_contract = ['currentEmp9. When did you start your current position?']

duration_contract = ['currentEmp11. What is the expected duration (in years) of your current position (in total)?']

german_orga = ['currentEmp20de. Which Fraunhofer institute do you work for?',
                 'currentEmp21de. Which Helmholtz institute do you work for?',
                 'currentEmp22de. Which Leibniz institute do you work for?',
                 'currentEmp23de. Which Max-Planck institute do you work for?',
                 'currentEmp24de. Which University of Applied Sciences?']

salary = ['socio4. Please select the range of your salary']

salary_de = ['socio10de. Please select your renumeration group according to your collective bargaining agreement']
 
salary_ausnzl = ['socio11ausnzl. What is the category of your pay-scale?',
                 'socio12ausnzl. What is your academic pay-level?',
                 'socio13ausnzl. What is your pay-level?',
                 'socio14ausnzl. What is your government pay-level?']

# Get the funding information
fund = [x for x in df.columns if x[:5] == 'fund2']


# ## Australia

# In[4]:


country = 'Australia'


# ### Type of organisation

# In[5]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country)
result


# In[6]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[7]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[8]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[9]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[10]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[11]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[12]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[13]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[14]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[15]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[16]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[17]:


category = 'Salary'
order_question = ['< AUD 45,000', '≥ AUD 45,000 and < AUD 65,000', '≥ AUD 65,000 and < AUD 85,000',
                  '≥ AUD 85,000 and < AUD 105,000', '≥ AUD 105,000 and < AUD 120,000', '≥ AUD 120,000']
# Check if there is no new answer between development and the list of answers manually created
try:
    df_salary = get_sampled_df(df, salary)
    assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
except AssertionError:
    print(set(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) - set(order_question))
    raise

result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[18]:


plot_cat_comparison(result, country, category, order_index=True)


# ### Funding

# In[19]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[20]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[21]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[22]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## Germany

# In[23]:


country = 'Germany'


# ### Type of organisation

# In[24]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country)
result


# In[25]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[26]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[27]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[28]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[29]:


plot_cat_comparison(result, country, category)


# ### Which organisation

# In[30]:


#list_new_val = ['Country', 'Year']
#for col in [x for x in df.columns if x not in list_new_val]:
list_new_val = ['Country', 'Year']
list_result = []
for col in german_orga:
    result = count_diff(df, col, category=category, country=country)
    list_result.append(result)
    result


# In[31]:


for result in list_result:
    plot_cat_comparison(result, country, category)


# ### Type of contract

# In[32]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[33]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[34]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[35]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[36]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[37]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[38]:


category = 'Salary'

order_question = ['Less than 27.499 EUR', 'Between 27.500 and 32.999 EUR', 'Between 33.000 and 38.499 EUR',
                  'Between 38.500 and 43.999 EUR', 'Between 44.000 and 49.999 EUR','Between 50.000 and 54.999 EUR',
                  'Between 55.000 and 65.999 EUR', 'Between 66.000 and 76.999 EUR', 'Between 77.000 and 109.999 EUR', 'Prefer not to say']
# Check if there is no new answer between development and the list of answers manually created
try:
    df_salary = get_sampled_df(df, salary)
    assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
except AssertionError:
    print(set(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) - set(order_question))
    raise
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[39]:


plot_cat_comparison(result, country, category)


# ### Funding

# In[40]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[41]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[42]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[43]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## Netherlands

# In[44]:


country = 'Netherlands'


# ### Type of organisation

# In[45]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country, disable_past_year=True)
result


# In[46]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[47]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[48]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[49]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[50]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[51]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[52]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[53]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[54]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[55]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[56]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[57]:


category = 'Salary'
order_question = ['Less than 27.499 EUR', 'Between 27.500 and 32.999 EUR', 'Between 33.000 and 38.499 EUR',
                  'Between 38.500 and 43.999 EUR', 'Between 44.000 and 49.999 EUR','Between 50.000 and 54.999 EUR',
                  'Between 55.000 and 65.999 EUR', 'Between 66.000 and 76.999 EUR', 'Between 77.000 and 109.999 EUR', 'Prefer not to say']
# Check if there is no new answer between development and the list of answers manually created
try:
    df_salary = get_sampled_df(df, salary)
    assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
except AssertionError:
    print(set(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) - set(order_question))
    raise
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[58]:


plot_cat_comparison(result, country, category, order_index=True)


# ### Funding

# In[59]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[60]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[61]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[62]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## New Zealand

# In[63]:


country = 'New Zealand'


# ### Type of organisation

# In[64]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country)
result


# In[65]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[66]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[67]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[68]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[69]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[70]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[71]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[72]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[73]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[74]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[75]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[76]:


category = 'Salary'
order_question = ['< NZD 45,000', 
                 '≥ NZD 45,000 and < NZD 65,000',
                  '≥ NZD 65,000 and < NZD 85,000',
                  '≥ NZD 85,000 and < NZD 105,000',
                  '≥ NZD 105,000 and < NZD 120,000', 
                  '≥ NZD 120,000']

# Check if there is no new answer between development and the list of answers manually created
try:
    df_salary = get_sampled_df(df, salary)
    assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
except AssertionError:
    print(set(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) - set(order_question))
    raise
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[77]:


plot_cat_comparison(result, country, category, order_index=True)


# ### Funding

# In[78]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[79]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[80]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[81]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## South Africa

# In[82]:


country = 'South Africa'


# ### Type of organisation

# In[83]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df,current_emp, category=category, country=country, disable_past_year=True)
result


# In[84]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[85]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[86]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[87]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[88]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[89]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[90]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[91]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[92]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[93]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[94]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[95]:


category = 'Salary'

order_question = ['Less than R 189 880',
                  'Between R 189 881 and R 296 540',
                  'Between R 296 541 and R 410 460',
                  'Between R 410 461 and R 555 600',
                  'Between R 555 601 and R 708 310',
                  'Between R 708 311 and R 1 500 000',
                  'More than R 1 500 000', 
                  'Prefer not to say']
# Check if there is no new answer between development and the list of answers manually created
try:
    assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
except AssertionError:
    print(set(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) - set(order_question))
    raise
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[96]:


plot_cat_comparison(result, country, category, order_index=True)


# ### Funding

# In[97]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[98]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[99]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[100]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## United Kingdom

# RSEs mainly work within universities: in total 73% work within a university. The other significant workplace for RSEs are the national laboratories where 10% of RSEs work. This is the same tendency as 2017.
# 
# About which university they are working for, the top 5 are University of Leeds (11%), University of Edinburgh (10%), University of Oxford (9%), University College London (UCL) (7%) and University of Manchester (7%). This is almost the same repartition of last year. Only University of Sheffield lost its position in favor of University of Leeds.
# 
# The vast majority works full-time (95%) and have either a Fixed term -- funded by project funds (36%) or a Permanent job (27%). Another 20% have a Permanent contract but funded by project, which can be interpreted as a fixed term.
# When they are asked how their RSE work is funded, 55% are supported by Grants and 34% by Institutional support, which is in line with the type of contract they have. However, up to 17% volunteer their time for their RSE works. 
# 
# 
# Half of RSEs are paid in the range of £32,277-£43,325, and around a quarter are paid in the range of £43,325-£58,172. This is significantly different to academic staff, where around a third of academics are paid in range of £32,277-£43,325 and a third in the range of £43,325-£58,172 (see [HESA](https://www.hesa.ac.uk/data-and-analysis/publications/staff-2015-16/introduction)). This is exaclty the same tendency as in 2017.

# In[101]:


country = 'United Kingdom'


# ### Type of organisation

# In[102]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country)
result


# In[103]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[104]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[105]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[106]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[107]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[108]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[109]:


plot_cat_comparison(result, country, category)


# ###  Type of contract

# In[110]:


#df[(df.Year == 2017) & (df.Country == 'United Kingdom')][nature_contract]


# In[111]:


#df[(df.Year == 2018) & (df.Country == 'United Kingdom')][nature_contract]


# In[112]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country, disable_past_year=True)
result


# In[113]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[114]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[115]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[116]:


category = 'Salary'
order_question = ['< £18,031',
                  '≥ £18,031 and < £24,057',
                  '≥ £24,057 and < £32,277',
                  '≥ £32,277 and < £43,325',
                  '≥ £43,325 and < £58,172',
                  '≥ £58,172']

# Check if there is no new answer between development and the list of answers manually created
assert(len(order_question) == len(df_salary[df_salary['Country'] == country]['socio4. Please select the range of your salary'].unique()) -1)
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[117]:


plot_cat_comparison(result, country, category, order_index=True)


# ### Funding

# In[118]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[119]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[120]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[121]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## United States

# In[122]:


country = 'United States'


# ### Type of organisation

# In[123]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country, disable_past_year=True)
result


# In[124]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[125]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[126]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[127]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[128]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[129]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[130]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[131]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[132]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[133]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[134]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Salary

# In[135]:


category = 'Salary'

order_question = ['Less than \\$30,000',
                  'From \\$30,000 to \\$49,999',
                  'From \\$50,000 to \\$69,999',
                  'From \\$70,000 to \\$89,999',
                  'From \\$90,000 to \\$109,999',
                  'From \\$110,000 to \\$129,999',
                  'From \\$130,000 to \\$149,999',
                  'More than \\$150,000',  
                  'Prefer not to say']
result = count_diff(df, salary, category=category, country=country, order_index=order_question)
result


# In[136]:


plot_cat_comparison(result, country, category, order_index=order_question)


# ### Funding

# In[137]:


# Funding
category = 'Type of funding'
result = count_diff(df, fund, category=category, country=country, multi_choice=True)
result


# In[138]:


plot_cat_comparison(result, country, category)


# ### Job title

# In[139]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[140]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)


# ## Rest of the World

# In[141]:


country = 'World'


# ### Type of organisation

# In[142]:


# Plotting the reported 'professional software developer'
category = 'Organisation type'
# Get the count
result = count_diff(df, current_emp, category=category, country=country)
result


# In[143]:


plot_cat_comparison(result, country, category)


# ### In which field are you working

# In[144]:


category = 'in which field'
results = count_diff(df, current_field, country=country, category=category, multi_choice=True)
results


# In[145]:


plot_cat_comparison(results, country=country, category=category)


# ### Which University

# In[146]:


# Plotting which university
category = 'Which university'
# Get the count
result = count_diff(df, which_uni, category=category, country=country)
result


# In[147]:


plot_cat_comparison(result, country, category)


# ### Type of contract

# In[148]:


category = 'Contract type'
# Get the count
result = count_diff(df, contract_time, category=category, country=country)
result


# In[149]:


plot_cat_comparison(result, country, category)


# ### Full time or part-time

# In[150]:


category = 'Nature of employment'
# Get the count
result = count_diff(df, nature_contract, category=category, country=country)
result


# In[151]:


plot_cat_comparison(result, country, category)


# ### Length of the current position

# In[152]:


category = 'Duration of contract in year'
# Get the count
result = describe_diff(df, duration_contract, category=category, country=country)
result


# In[153]:


plot_density_func(df, columns=duration_contract, country=country, category=category, remove_outliers=True)


# ### Job title

# In[154]:


category = 'Official job title'
plot_wordcloud(df, title_job, country, category)


# In[155]:


category = 'Different job title'
plot_wordcloud(df, title_job, country, category)

